/* ProjectName:Task ProjectVersion: 39 | OfflinePackageVersion:39 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b34d6"],{2893:function(t,e,a){"use strict";var n=a("2909"),r=a("53ca"),s=a("5530"),i=a("1da1"),o=(a("96cf"),a("7db0"),a("d3b7"),a("caad"),a("e25e"),a("2532"),a("e9c4"),a("ac1f"),a("5319"),a("25f0"),a("99af"),a("00b4"),a("d81d"),a("eec5")),c=a("365c"),u=a("d88a"),p=a("57ef"),l=a("495f"),d="".concat("https://shareit.hpyfeds.com","/mvp_static/images/offerwall/default_icon.webp");e["a"]={data:function(){return{defaultIcon:d,iconError:'this.src = "'.concat(d,'"'),cashConfigMap:{ID:{rate:10,symbol:"Rp"},PH:{rate:1e3,symbol:"₱"},MY:{rate:1e5,symbol:"RM"},EG:{rate:1e4,symbol:"EGP"},RU:{rate:1e3,symbol:"₽"},ZA:{rate:1e4,symbol:"R"},BR:{rate:1e5,symbol:"R$"}}}},props:{pveCur:{type:String,default:""}},computed:{taskCode:function(t){var e=t.taskData;return e.task_code},taskClass:function(t){var e=t.taskData;return e.task_class},taskIcon:function(t){var e,a=t.taskData,n=t.adInfo,r=t.defaultIcon;return n.icon_url||(null===a||void 0===a||null===(e=a.detail)||void 0===e?void 0:e.icon_url)||r},taskTitle:function(t){var e,a=t.taskData,n=t.adInfo;return n.ad_app_name||(null===a||void 0===a||null===(e=a.detail)||void 0===e?void 0:e.title)||""},taskDesc:function(t){var e=t.adInfo,a=t.isClientReport;return e.title||(a?this.$t("Offerwall.clientReportDescDefault"):"")},taskCoins:function(t){var e=t.taskData;return e.detail.show_coin_num},isMultiEvent:function(t){var e=t.taskData;return e.coin_cfg.total>1},leftTime:function(t){var e=t.taskData;return e.detail.term_of_validity},taskIsDone:function(t){var e=t.taskData;return Object(o["a"])(e)},eventInfo:function(t){var e=t.taskData,a=t.taskClass,n=Object(o["c"])(e);return a===p["x"]?n&&n.find((function(t){return 0===t.finish_status}))||n[0]:n},adInfo:function(){return this.eventInfo&&this.eventInfo.ad_info||{}},pwAppStatusData:function(){return this.$store.state.pwModule.pwAppStatusData},appData:function(){var t={action:"unknown"};if(this.eventInfo){var e=this.adInfo.ad_app_pkg_name,a=void 0===e?"":e,n=this.pwAppStatusData[a];return n||t}return t},appStatus:function(t){var e=t.appData,a=e&&e.action||"",n={delete:"download"};return n[a]||a},appIsInstalled:function(t){var e=t.appStatus;return"installed"===e},downloadProgress:function(t){var e=t.appStatus,a=t.appData;if(["progress","pause","start"].includes(e)){var n=a.total,r=a.completed,s=parseInt(r/n*100),i=s>100?100:s;return i}return 0},taskHasReportStart:function(){if(this.eventInfo){var t=this.$store.state.pwModule.pwHasStartList;return t.includes(this.taskCode)}return!1},taskIsStart:function(t){var e=t.taskData,a=t.taskHasReportStart;return!!e.detail.is_start||a},taskItemShowLog:function(){var t=Object(o["d"])(this.taskData),e=this.getLogParams({eventId:"show_ve",extras:t}),a="",n=this.adInfo,r=n.imp_track_urls,s=n.view_id;return Array.isArray(r)&&(a=Object(l["g"])(r,"__VIEWID__",s)),JSON.stringify({logData:{params:e},trackUrls:a})},taskTags:function(t){var e=t.taskData,a=e.detail.tags;return a&&a.length>0?a:null},pwChannel:function(t){var e=t.taskData;return e.detail.pw_channel||""},showCash:function(t){var e=t.cashConfigMap,a=this.$store.getters.isGpChannel,n=this.$store.state.country;return!a&&e[n]},isClientReport:function(){var t=this.adInfo.attribution_type;return 2===t},country:function(){return this.$store.state.country},eventName:function(t){var e=t.adInfo;return(null===e||void 0===e?void 0:e.shareit_event_name)||""}},created:function(){!this.taskIsDone&&this.eventInfo&&this.getAppStatus()},methods:{getCash:function(t){var e=this.cashConfigMap[this.country];if(e){var a=e.rate,n=e.symbol;if("BR"===this.country){var r=t>a?parseInt(t/a):(t/a).toFixed(2);return 0===r&&(r=.01),r=r.toString().replace(".",","),"".concat(n," ").concat(r)}var s=t>a?parseInt(t/a):1;return"".concat(n," ").concat(s)}return""},getAppStatus:function(){var t=this.adInfo,e=t.ad_app_name,a=t.ad_app_pkg_name,n=t.h5_landing_page;"net_alliance"===this.pwChannel&&(n=this.getNetAllianceUrl());var r={pkgName:a,url:n,name:e,pwChannel:this.pwChannel};this.$store.dispatch("getPwAppStatus",r)},checkUpdate:function(){var t,e,a=this.$store.state.pwModule.isSkipLimit;if(a)return!1;var n=null===(t=this.taskData)||void 0===t||null===(e=t.detail)||void 0===e?void 0:e.upgrade;if(n){var r,s,i=null===(r=this.taskData)||void 0===r||null===(s=r.detail)||void 0===s?void 0:s.upgrade_url;this.$store.commit("setHomeTaskUpgradeInfo",{url:i,taskCode:this.taskCode}),this.$store.commit("switchHomeUpgrade",!0)}return n},taskBtnClick:function(t,e){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a._logTaskClick(e),!a.checkUpdate()){n.next=3;break}return n.abrupt("return");case 3:if("go"!==t){n.next=8;break}a.handleTaskGo(e),n.next=25;break;case 8:if("done"!==t){n.next=13;break}return n.abrupt("return");case 13:if("reportStart"!==t){n.next=21;break}return n.next=16,a.reportTaskStart();case 16:a.taskIsStart&&"pause"===a.appStatus&&a.clickDownloadBtn(),n.next=25;break;case 21:if("PwTaskItem"!==a.$options.name){n.next=24;break}return a.showDetailPop(),n.abrupt("return");case 24:a.clickDownloadBtn();case 25:case"end":return n.stop()}}),n)})))()},getNetAllianceUrl:function(){var t=this.taskCode;return this.$store.state.pwModule.savedNetAllianceJumpUrl[t]||""},clickDownloadBtn:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,s,i,o,c,u,p,d,f,_,k,h,v,m,g,w,b,C,S,I,D,y,$,x,O,N,P,R,T;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t&&t.ad_info||e.adInfo,r=n.ad_app_name,s=n.ad_app_pkg_name,i=n.ad_app_size,o=n.attribution_tracker_url,c=void 0===o?"":o,u=n.phy_pos_id,p=n.h5_landing_page||"","net_alliance"!==e.pwChannel){a.next=19;break}if(e.getNetAllianceUrl()){a.next=14;break}return d=e.$t("defaultError"),a.next=9,e.reportNetAllianceTrackUrl(c);case 9:if(f=a.sent,f){a.next=14;break}return e.$toast(d),a.abrupt("return");case 14:if(p=e.getNetAllianceUrl(),"download"!==e.appStatus){a.next=19;break}return _={pkgName:s,url:p,name:r,pwChannel:e.pwChannel,useSavedStatus:!1},a.next=19,e.$store.dispatch("checkPwAppIsInstalled",_);case 19:if("pause"!==e.appStatus){a.next=23;break}e.$store.dispatch("getPwAppStatus",{pkgName:s,url:p,name:r,mode:"2",pwChannel:e.pwChannel}),a.next=47;break;case 23:if("progress"!==e.appStatus){a.next=27;break}e.$store.dispatch("getPwAppStatus",{pkgName:s,url:p,name:r,mode:"1",pwChannel:e.pwChannel}),a.next=47;break;case 27:if("installed"!==e.appStatus&&"download"!==e.appStatus&&"complete"!==e.appStatus){a.next=46;break}if(k=c,"midas_dsp"===e.pwChannel?k=c.replace("{uagent}"):"net_alliance"===e.pwChannel&&(k=""),h={pkgName:s,url:p,name:r,fileSize:i||100,trackUrls:k,taskCode:e.taskCode,pwChannel:e.pwChannel},u&&(h.pid=u),e.taskIsStart||"complete"!==e.appStatus&&"download"!==e.appStatus){a.next=39;break}return a.next=35,e.reportTaskStart();case 35:if(v=a.sent,v){a.next=39;break}return a.abrupt("return");case 39:if(m=/^https?:\/\/.*\.(s?apk)$/i.test(p),g="RU"===e.country,g&&m&&"complete"===e.appStatus?(w=n.click_track_urls,b=n.view_id,C=Object(l["g"])(w,"__VIEWID__",b),Object(l["f"])(C)):m&&("download"!==e.appStatus||g)||(S=!0,"entryPwPop"===e.currentHandlePos&&(I=e.getOrSetTargetHasHandledToady("get","mvpOfferwallAutoClick",e.taskCode),I?S=!1:e.getOrSetTargetHasHandledToady("set","mvpOfferwallAutoClick",e.taskCode)),S&&(e.$stLog({params:{eventId:"click_ve",pve_cur:"/mvpOfferwall/trackUrl/click",extras:{pveCur:e.pveCur,isDownloadForceGp:e.$store.state.pwModule.isDownloadForceGp,taskCode:e.taskCode}}}),D=n.click_track_urls,y=n.view_id,$=Object(l["g"])(D,"__VIEWID__",y),Object(l["f"])($))),e.$store.dispatch("handlePwDownload",h),"complete"===e.appStatus)try{x=e.$store.state.deviceData,O=x.manufacturer,N=void 0===O?"":O,P=/xiaomi|redmi/.test(N.toLowerCase()),R=/sapk$/.test(p),P&&R&&(T=e.$t("Offerwall.pwXiaomiTips"),T&&e.$toast(T))}catch(j){}a.next=47;break;case 46:"unknown"!==e.appStatus&&"failed"!==e.appStatus||e.$toast("system busy");case 47:case"end":return a.stop()}}),a)})))()},handleTaskGo:function(t){var e=this,a=t||this.eventInfo,n=a.ad_info||{};if(1!==a.finish_status){var r=n.click_track_urls,s=n.view_id;try{var i=Object(l["g"])(r,"__VIEWID__",s);Object(l["f"])(i)}catch(o){}this.getAppStatus(),setTimeout((function(){if(e.appIsInstalled){var t=a.event_id,r=n.attribution_tracker_url,s=void 0===r?"":r,i=n.ad_app_name,o=n.ad_app_pkg_name,u=n.ad_app_size,p=n.phy_pos_id,l=n.attribution_type,d=n.duration,f=n.duration_prompt,_=2===l,k=n.h5_landing_page;if("net_alliance"===e.pwChannel&&(k=e.getNetAllianceUrl()),_)e.$store.commit("setPwClientReportData",{begin_time:(new Date).getTime(),task_code:e.taskCode,event_id:t,task_class:e.taskClass,event_name:e.eventName,duration:d,duration_prompt:f});else{var h=n.phy_pos_id,v=n.ad_id,m={task_code:e.taskCode,event_id:t,phy_pos_id:h,ad_id:v,extra_info:JSON.stringify({portal:e.$portal})};"Lottery"===e.$projectName&&(m.prize_code="pw"),Object(c["g"])(m).catch((function(t){}))}var g=s;"midas_dsp"===e.pwChannel?g=s.replace("{uagent}"):"net_alliance"===e.pwChannel&&(g="");var w={pkgName:o,url:k,name:i,fileSize:u||100,trackUrls:g,pid:p,taskCode:e.taskCode,pwChannel:e.pwChannel};e.$store.dispatch("handlePwDownload",w)}else e.$toast("please try later!")}),100)}},reportTaskStart:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,r,s,i,o,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t.taskData.task_code,n=t.eventInfo.event_id,r=t.adInfo,s=r.phy_pos_id,i=r.ad_id,t.$store.commit("setPwLoading",!0),o={task_code:a,event_id:n,phy_pos_id:s,ad_id:i,extra_info:JSON.stringify({portal:t.$portal})},"Lottery"===t.$projectName&&(o.prize_code="pw"),e.next=8,Object(c["g"])(o).then((function(e){return t.$store.commit("setPwLoading",!1),!(!e||200!==e.result_code||1!==e.data.status)&&(t.$store.commit("setPwStartTask",t.taskCode),t.$emit("reportStartSuccess",t.taskData),!0)})).catch((function(e){return t.$store.commit("setPwLoading",!1),!1}));case 8:return u=e.sent,u?t.hasReportStart=!0:t.$toast(t.$t("defaultError")),e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)})))()},reportNetAllianceTrackUrl:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.$store.commit("setPwLoading",!0),a.next=3,Object(u["b"])({attr_url:encodeURIComponent(t),task_code_list:[e.taskCode]},{getOriginResponse:!0}).then((function(t){return e.$store.commit("setPwLoading",!1),!(200!==t.result_code||!t.data.url)&&(e.$store.commit("setNetAllianceJumpUrl",{task_code:e.taskCode,url:t.data.url}),!0)})).catch((function(t){return e.$store.commit("setPwLoading",!1),!1}));case 3:return n=a.sent,a.abrupt("return",n);case 6:case"end":return a.stop()}}),a)})))()},getLogParams:function(t){var e=t.eventId,a=t.extras,n=void 0===a?{}:a,r=Object(s["a"])({status:this.taskIsDone?2:0,value:this.taskCoins,app_status:this.appStatus},n);return[p["w"],p["v"],p["u"]].includes(this.taskClass)&&(r.days=this.taskData.current),{eventId:e,pve_cur:this.pveCur+this.taskCode,item:JSON.stringify({task_code:this.taskCode,type:this.logType||""}),extras:r}},_logTaskClick:function(t){var e=t||this.eventInfo,a={};if(e&&(a.event_id=e.event_id,a.pkg_name=e.ad_info.ad_app_pkg_name,a.value=e.prize_count,a.status=0===e.finish_status?0:2),this.taskClass===p["x"]){var n=Object(o["c"])(this.taskData);a.sub_task=n.map((function(t){return{event_id:t.event_id,status:t.finish_status}}))}var r=this.getLogParams({eventId:"click_ve",extras:a});this.$stLog({params:r})},getOrSetTargetHasHandledToady:function(t,e,a){var s=localStorage.getItem(e),i=(new Date).getDate(),o=[];try{var c=JSON.parse(s);c&&"object"===Object(r["a"])(c)&&c.date===i&&(o=c.savedKeys||[])}catch(u){}if("set"===t){if(o.includes(a))return;localStorage.setItem(e,JSON.stringify({date:i,savedKeys:[].concat(Object(n["a"])(o),[a])}))}if("get"===t)return o.includes(a)}}}}}]);